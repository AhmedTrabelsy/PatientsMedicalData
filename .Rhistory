knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
# Installer les packages si n√©cessaires :
# install.packages(c("tidyverse", "skimr", "GGally", "psych", "broom"))
library(tidyverse)
library(skimr)
library(GGally)
library(psych)
library(broom)
data <- read.csv(file.choose(),
sep = ";",
header = TRUE,
stringsAsFactors = FALSE,
na.strings = c("", "NA", "NaN", "NULL", "?"))
# üëÄ Aper√ßu rapide du jeu de donn√©es
head(data)
str(data)
data <- data %>%
rename(
ID = ID,
Age = Age,
Sexe = Sexe,
Poids = Poids,
Tension = Tension,
Cholesterol = Cholesterol,
Groupe_Traitement = Groupe_Traitement,
Suivi_Jours = Suivi_Jours,
Symptom_Score = Symptom_Score
) %>%
mutate(
Sexe = as.factor(Sexe),
Groupe_Traitement = as.factor(Groupe_Traitement)
)
# Suppression des doublons
data <- distinct(data)
# R√©sum√© rapide
skim(data)
colSums(is.na(data))
data <- na.omit(data)
nrow(data)
quant_vars <- c("Age", "Poids", "Tension", "Cholesterol", "Suivi_Jours", "Symptom_Score")
data %>%
select(all_of(quant_vars)) %>%
summary()
# Histogrammes
for (v in quant_vars) {
print(
ggplot(data, aes_string(x = v)) +
geom_histogram(bins = 20, fill = "steelblue", color = "white") +
geom_density(alpha = 0.4, color = "red") +
labs(title = paste("Distribution de", v))
)
}
for (v in quant_vars) {
cat("Variable :", v, "\n")
x <- data[[v]]
if (length(x) > 5000) x <- sample(x, 5000)
print(shapiro.test(x))
cat("\n---------------------------------\n")
}
table(data$Sexe)
table(data$Groupe_Traitement)
ggplot(data, aes(x = Sexe)) +
geom_bar(fill = "#3498db") +
labs(title = "R√©partition par sexe", x = "Sexe", y = "Effectif")
ggplot(data, aes(x = Groupe_Traitement)) +
geom_bar(fill = "#2ecc71") +
labs(title = "R√©partition par groupe de traitement", x = "Groupe", y = "Effectif")
cor_matrix <- cor(data[, quant_vars])
cor_matrix
GGally::ggcorr(data[, quant_vars], label = TRUE)
cor.test(data$Age, data$Symptom_Score)
ggplot(data, aes(x = Age, y = Symptom_Score)) +
geom_point() +
geom_smooth(method = "lm", color = "red") +
labs(title = "√Çge vs Score de sympt√¥mes")
ggplot(data, aes(x = Groupe_Traitement, y = Symptom_Score, fill = Groupe_Traitement)) +
geom_boxplot() +
labs(title = "Score selon le groupe de traitement")
# Test ANOVA
anova_test <- aov(Symptom_Score ~ Groupe_Traitement, data = data)
summary(anova_test)
# Test non param√©trique
kruskal.test(Symptom_Score ~ Groupe_Traitement, data = data)
tab <- table(data$Sexe, data$Groupe_Traitement)
tab
chisq.test(tab)
model <- lm(Symptom_Score ~ Age + Sexe + Poids + Tension +
Cholesterol + Groupe_Traitement + Suivi_Jours, data = data)
summary(model)
broom::tidy(model)
par(mfrow = c(2, 2))
plot(model)
par(mfrow = c(1, 1))
