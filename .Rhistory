psych::describe(numeric_vars)
numeric_vars_long <- data_clean %>%
select(Age, Poids, Tension, Cholesterol, Suivi_Jours, Symptom_Score) %>%
pivot_longer(cols = everything(), names_to = "Variable", values_to = "Valeur")
ggplot(numeric_vars_long, aes(x = Valeur)) +
geom_histogram(bins = 30, color = "black", fill = "steelblue", alpha = 0.7) +
facet_wrap(~ Variable, scales = "free") +
theme_minimal() +
labs(title = "Histogrammes des variables quantitatives")
ggplot(numeric_vars_long, aes(y = Valeur)) +
geom_boxplot(fill = "tomato", alpha = 0.7) +
facet_wrap(~ Variable, scales = "free") +
theme_minimal() +
labs(title = "Boxplots des variables quantitatives")
apply(numeric_vars, 2, function(x) {
shapiro.test(x)$p.value
})
table(data_clean$Sexe)
prop.table(table(data_clean$Sexe))
table(data_clean$Groupe_Traitement)
prop.table(table(data_clean$Groupe_Traitement))
ggplot(data_clean, aes(x = Sexe)) +
geom_bar(fill = "steelblue") +
theme_minimal() +
labs(title = "Répartition des patients par sexe", x = "Sexe", y = "Effectif")
ggplot(data_clean, aes(x = Groupe_Traitement)) +
geom_bar(fill = "darkseagreen") +
theme_minimal() +
labs(title = "Répartition par groupe de traitement", x = "Groupe de traitement", y = "Effectif")
cor_matrix <- cor(numeric_vars, use = "complete.obs")
cor_matrix
GGally::ggcorr(numeric_vars, label = TRUE)
cor.test(data_clean$Age, data_clean$Symptom_Score)
ggplot(data_clean, aes(x = Age, y = Symptom_Score)) +
geom_point(alpha = 0.7) +
geom_smooth(method = "lm", color = "red", se = TRUE) +
theme_minimal() +
labs(title = "Âge vs Score de symptômes",
x = "Âge",
y = "Score de symptômes")
ggplot(data_clean, aes(x = Groupe_Traitement, y = Symptom_Score, fill = Groupe_Traitement)) +
geom_boxplot(alpha = 0.8) +
theme_minimal() +
labs(title = "Score de symptômes selon le groupe de traitement",
x = "Groupe de traitement",
y = "Score de symptômes") +
theme(legend.position = "none")
anova_model <- aov(Symptom_Score ~ Groupe_Traitement, data = data_clean)
summary(anova_model)
t.test(Symptom_Score ~ Sexe, data = data_clean, var.equal = FALSE)
tab_sexe_traitement <- table(data_clean$Sexe, data_clean$Groupe_Traitement)
tab_sexe_traitement
chisq.test(tab_sexe_traitement)
modele_lm <- lm(
Symptom_Score ~ Age + Sexe + Poids + Tension + Cholesterol + Groupe_Traitement + Suivi_Jours,
data = data_clean
)
summary(modele_lm)
tidy(modele_lm, conf.int = TRUE)
ggplot(data.frame(
fitted = fitted(modele_lm),
resid = resid(modele_lm)
), aes(x = fitted, y = resid)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype = "dashed") +
theme_minimal() +
labs(title = "Résidus vs valeurs ajustées",
x = "Valeurs ajustées",
y = "Résidus")
qqnorm(resid(modele_lm))
qqline(resid(modele_lm), col = "red")
shapiro.test(resid(modele_lm))
vif(modele_lm)
knitr::opts_chunk$set(
echo = TRUE,
message = FALSE,
warning = FALSE
)
required_packages <- c(
"tidyverse",
"skimr",
"GGally",
"psych",
"broom",
"car"
)
installed <- rownames(installed.packages())
for (p in required_packages) {
if (!p %in% installed) {
install.packages(p, dependencies = TRUE)
}
}
library(tidyverse)
library(skimr)
library(GGally)
library(psych)
library(broom)
library(car)
library(dplyr)
library(ggplot2)
data <- read.csv(
"patients_medical_data.csv",
sep = ";",
header = TRUE,
stringsAsFactors = FALSE,
na.strings = c("", "NA", "NaN", "NULL", "?")
)
# Aperçu des premières lignes
head(data)
# Structure des données
str(data)
data <- data %>%
mutate(
Sexe = as.factor(Sexe),
Groupe_Traitement = as.factor(Groupe_Traitement)
)
# Vérification des types
str(data)
# Nombre de NA par variable
colSums(is.na(data))
# Proportion de NA par variable
sapply(data, function(x) mean(is.na(x)))
#  imputation avec median pour une valeur manquante
data_clean <- data %>%
mutate(
Poids       = ifelse(is.na(Poids),       median(Poids, na.rm = TRUE),       Poids),
Tension     = ifelse(is.na(Tension),     median(Tension, na.rm = TRUE),     Tension),
Cholesterol = ifelse(is.na(Cholesterol), median(Cholesterol, na.rm = TRUE), Cholesterol)
)
# Vérification :  aucun NA
colSums(is.na(data_clean))
# Vérification du nombre de doublons complets (lignes identiques à 100%)
nb_doublons <- sum(duplicated(data) | duplicated(data, fromLast = TRUE))
cat("Nombre de lignes en doublon complet :", nb_doublons, "\n")
# Vérification de valeus aberrantes
data_clean %>%
select(Poids, Tension, Cholesterol, Age, Suivi_Jours, Symptom_Score) %>%
pivot_longer(everything(), names_to = "Variable", values_to = "Valeur") %>%
ggplot(aes(x = Variable, y = Valeur)) +
geom_boxplot(fill = "lightblue", outlier.colour = "red", outlier.size = 3) +
facet_wrap(~ Variable, scales = "free_y") +
theme_minimal() +
labs(title = "Détection des valeurs aberrantes par boxplot",
caption = "Points rouges = outliers selon la règle IQR")
vars_quant <- c("Age", "Poids", "Tension", "Cholesterol", "Suivi_Jours", "Symptom_Score")
# Fonction pour détecter les outliers (méthode IQR)
detect_outliers <- function(x) {
Q1 <- quantile(x, 0.25, na.rm = TRUE)
Q3 <- quantile(x, 0.75, na.rm = TRUE)
IQR <- Q3 - Q1
lower <- Q1 - 1.5 * IQR
upper <- Q3 + 1.5 * IQR
which(x < lower | x > upper)
}
# Comptage des outliers par variable
outliers_count <- sapply(data_clean[vars_quant], function(x) length(detect_outliers(x)))
outliers_count
# Visualisation avec boxplots
data_clean_long <- data_clean %>%
select(all_of(vars_quant)) %>%
pivot_longer(everything(), names_to = "Variable", values_to = "Valeur")
ggplot(data_clean_long, aes(x = Variable, y = Valeur)) +
geom_boxplot(fill = "#69b3a2", color = "black") +
theme_minimal() +
labs(title = "Boxplots des variables quantitatives (détection des outliers)",
subtitle = "Méthode IQR × 1.5") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
skim(data_clean)
numeric_vars <- data_clean %>%
select(Age, Poids, Tension, Cholesterol, Suivi_Jours, Symptom_Score)
summary(numeric_vars)
psych::describe(numeric_vars)
numeric_vars_long <- data_clean %>%
select(Age, Poids, Tension, Cholesterol, Suivi_Jours, Symptom_Score) %>%
pivot_longer(cols = everything(), names_to = "Variable", values_to = "Valeur")
ggplot(numeric_vars_long, aes(x = Valeur)) +
geom_histogram(bins = 30, color = "black", fill = "steelblue", alpha = 0.7) +
facet_wrap(~ Variable, scales = "free") +
theme_minimal() +
labs(title = "Histogrammes des variables quantitatives")
ggplot(numeric_vars_long, aes(y = Valeur)) +
geom_boxplot(fill = "tomato", alpha = 0.7) +
facet_wrap(~ Variable, scales = "free") +
theme_minimal() +
labs(title = "Boxplots des variables quantitatives")
apply(numeric_vars, 2, function(x) {
shapiro.test(x)$p.value
})
table(data_clean$Sexe)
prop.table(table(data_clean$Sexe))
table(data_clean$Groupe_Traitement)
prop.table(table(data_clean$Groupe_Traitement))
ggplot(data_clean, aes(x = Sexe)) +
geom_bar(fill = "steelblue") +
theme_minimal() +
labs(title = "Répartition des patients par sexe", x = "Sexe", y = "Effectif")
ggplot(data_clean, aes(x = Groupe_Traitement)) +
geom_bar(fill = "darkseagreen") +
theme_minimal() +
labs(title = "Répartition par groupe de traitement", x = "Groupe de traitement", y = "Effectif")
cor_matrix <- cor(numeric_vars, use = "complete.obs")
cor_matrix
GGally::ggcorr(numeric_vars, label = TRUE)
cor.test(data_clean$Age, data_clean$Symptom_Score)
ggplot(data_clean, aes(x = Age, y = Symptom_Score)) +
geom_point(alpha = 0.7) +
geom_smooth(method = "lm", color = "red", se = TRUE) +
theme_minimal() +
labs(title = "Âge vs Score de symptômes",
x = "Âge",
y = "Score de symptômes")
ggplot(data_clean, aes(x = Groupe_Traitement, y = Symptom_Score, fill = Groupe_Traitement)) +
geom_boxplot(alpha = 0.8) +
theme_minimal() +
labs(title = "Score de symptômes selon le groupe de traitement",
x = "Groupe de traitement",
y = "Score de symptômes") +
theme(legend.position = "none")
anova_model <- aov(Symptom_Score ~ Groupe_Traitement, data = data_clean)
summary(anova_model)
t.test(Symptom_Score ~ Sexe, data = data_clean, var.equal = FALSE)
tab_sexe_traitement <- table(data_clean$Sexe, data_clean$Groupe_Traitement)
tab_sexe_traitement
chisq.test(tab_sexe_traitement)
modele_lm <- lm(
Symptom_Score ~ Age + Sexe + Poids + Tension + Cholesterol + Groupe_Traitement + Suivi_Jours,
data = data_clean
)
summary(modele_lm)
tidy(modele_lm, conf.int = TRUE)
ggplot(data.frame(
fitted = fitted(modele_lm),
resid = resid(modele_lm)
), aes(x = fitted, y = resid)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype = "dashed") +
theme_minimal() +
labs(title = "Résidus vs valeurs ajustées",
x = "Valeurs ajustées",
y = "Résidus")
qqnorm(resid(modele_lm))
qqline(resid(modele_lm), col = "red")
shapiro.test(resid(modele_lm))
vif(modele_lm)
vars_quant <- c("Age", "Poids", "Tension", "Cholesterol", "Suivi_Jours", "Symptom_Score")
# Fonction pour détecter les outliers (méthode IQR)
detect_outliers <- function(x) {
Q1 <- quantile(x, 0.25, na.rm = TRUE)
Q3 <- quantile(x, 0.75, na.rm = TRUE)
IQR <- Q3 - Q1
lower <- Q1 - 1.5 * IQR
upper <- Q3 + 1.5 * IQR
which(x < lower | x > upper)
}
# Comptage des outliers par variable
outliers_count <- sapply(data_clean[vars_quant], function(x) length(detect_outliers(x)))
outliers_count
# Visualisation avec boxplots
data_clean_long <- data_clean %>%
select(all_of(vars_quant)) %>%
pivot_longer(everything(), names_to = "Variable", values_to = "Valeur")
ggplot(data_clean_long, aes(x = Variable, y = Valeur)) +
geom_boxplot(fill = "lightblue", color = "red",outlier.size = 3) +
theme_minimal() +
labs(title = "Boxplots des variables quantitatives (détection des outliers)",
subtitle = "Méthode IQR × 1.5") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
vars_quant <- c("Age", "Poids", "Tension", "Cholesterol", "Suivi_Jours", "Symptom_Score")
# Fonction pour détecter les outliers (méthode IQR)
detect_outliers <- function(x) {
Q1 <- quantile(x, 0.25, na.rm = TRUE)
Q3 <- quantile(x, 0.75, na.rm = TRUE)
IQR <- Q3 - Q1
lower <- Q1 - 1.5 * IQR
upper <- Q3 + 1.5 * IQR
which(x < lower | x > upper)
}
# Comptage des outliers par variable
outliers_count <- sapply(data_clean[vars_quant], function(x) length(detect_outliers(x)))
outliers_count
# Visualisation avec boxplots
data_clean_long <- data_clean %>%
select(all_of(vars_quant)) %>%
pivot_longer(everything(), names_to = "Variable", values_to = "Valeur")
ggplot(data_clean_long, aes(x = Variable, y = Valeur)) +
geom_boxplot(fill = "lightblue", outlier.colour = "red", outlier.size = 3) +
theme_minimal() +
labs(title = "Boxplots des variables quantitatives (détection des outliers)",
subtitle = "Méthode IQR × 1.5") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
```{r val_aberante, fig.height=8, fig.width=10}
# Variables dans l'ordre que tu veux afficher
vars_quant <- c("Age", "Poids", "Tension", "Cholesterol", "Suivi_Jours", "Symptom_Score")
data_clean %>%
select(all_of(vars_quant)) %>%
pivot_longer(everything(), names_to = "Variable", values_to = "Valeur") %>%
# Ici la clé : on transforme Variable en factor avec l'ordre désiré
mutate(Variable = factor(Variable, levels = vars_quant)) %>%
ggplot(aes(x = Variable, y = Valeur)) +
geom_boxplot(fill = "lightblue", outlier.colour = "red", outlier.size = 5) +
facet_wrap(~ Variable, scales = "free_y", ncol = 3) +  # ncol=3 pour une meilleure disposition
theme_minimal() +
theme(
axis.text.x = element_blank(),        # On enlève les labels x redondants sous chaque boxplot
axis.ticks.x = element_blank(),       # Et les ticks aussi
strip.text = element_text(size = 12, face = "bold")  # Les titres des facets plus lisibles
) +
labs(
title = "Détection des valeurs aberrantes par boxplot",
caption = "Points rouges = outliers selon la règle IQR"
)
# Variables dans l'ordre que tu veux afficher
vars_quant <- c("Age", "Poids", "Tension", "Cholesterol", "Suivi_Jours", "Symptom_Score")
data_clean %>%
select(all_of(vars_quant)) %>%
pivot_longer(everything(), names_to = "Variable", values_to = "Valeur") %>%
# Ici la clé : on transforme Variable en factor avec l'ordre désiré
mutate(Variable = factor(Variable, levels = vars_quant)) %>%
ggplot(aes(x = Variable, y = Valeur)) +
geom_boxplot(fill = "lightblue", outlier.colour = "red", outlier.size = 3) +
facet_wrap(~ Variable, scales = "free_y", ncol = 3) +
theme_minimal() +
theme(
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
strip.text = element_text(size = 12, face = "bold")
) +
labs(
title = "Détection des valeurs aberrantes par boxplot",
caption = "Points rouges = outliers selon la règle IQR"
)
knitr::opts_chunk$set(
echo = TRUE,
message = FALSE,
warning = FALSE
)
required_packages <- c(
"tidyverse",
"skimr",
"GGally",
"psych",
"broom",
"car"
)
installed <- rownames(installed.packages())
for (p in required_packages) {
if (!p %in% installed) {
install.packages(p, dependencies = TRUE)
}
}
library(tidyverse)
library(skimr)
library(GGally)
library(psych)
library(broom)
library(car)
library(dplyr)
library(ggplot2)
data <- read.csv(
"patients_medical_data.csv",
sep = ";",
header = TRUE,
stringsAsFactors = FALSE,
na.strings = c("", "NA", "NaN", "NULL", "?")
)
# Aperçu des premières lignes
head(data)
# Structure des données
str(data)
data <- data %>%
mutate(
Sexe = as.factor(Sexe),
Groupe_Traitement = as.factor(Groupe_Traitement)
)
# Vérification des types
str(data)
# Nombre de NA par variable
colSums(is.na(data))
# Proportion de NA par variable
sapply(data, function(x) mean(is.na(x)))
#  imputation avec median pour une valeur manquante
data_clean <- data %>%
mutate(
Poids       = ifelse(is.na(Poids),       median(Poids, na.rm = TRUE),       Poids),
Tension     = ifelse(is.na(Tension),     median(Tension, na.rm = TRUE),     Tension),
Cholesterol = ifelse(is.na(Cholesterol), median(Cholesterol, na.rm = TRUE), Cholesterol)
)
# Vérification :  aucun NA
colSums(is.na(data_clean))
# Vérification du nombre de doublons complets (lignes identiques à 100%)
nb_doublons <- sum(duplicated(data) | duplicated(data, fromLast = TRUE))
cat("Nombre de lignes en doublon complet :", nb_doublons, "\n")
# Variables dans l'ordre que tu veux afficher
vars_quant <- c("Age", "Poids", "Tension", "Cholesterol", "Suivi_Jours", "Symptom_Score")
data_clean %>%
select(all_of(vars_quant)) %>%
pivot_longer(everything(), names_to = "Variable", values_to = "Valeur") %>%
# Ici la clé : on transforme Variable en factor avec l'ordre désiré
mutate(Variable = factor(Variable, levels = vars_quant)) %>%
ggplot(aes(x = Variable, y = Valeur)) +
geom_boxplot(fill = "lightblue", outlier.colour = "red", outlier.size = 3) +
facet_wrap(~ Variable, scales = "free_y", ncol = 3) +
theme_minimal() +
theme(
axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
strip.text = element_text(size = 12, face = "bold")
) +
labs(
title = "Détection des valeurs aberrantes par boxplot",
caption = "Points rouges = outliers selon la règle IQR"
)
vars_quant <- c("Age", "Poids", "Tension", "Cholesterol", "Suivi_Jours", "Symptom_Score")
# Fonction pour détecter les outliers (méthode IQR)
detect_outliers <- function(x) {
Q1 <- quantile(x, 0.25, na.rm = TRUE)
Q3 <- quantile(x, 0.75, na.rm = TRUE)
IQR <- Q3 - Q1
lower <- Q1 - 1.5 * IQR
upper <- Q3 + 1.5 * IQR
which(x < lower | x > upper)
}
# Comptage des outliers par variable
outliers_count <- sapply(data_clean[vars_quant], function(x) length(detect_outliers(x)))
outliers_count
# Visualisation avec boxplots
data_clean_long <- data_clean %>%
select(all_of(vars_quant)) %>%
pivot_longer(everything(), names_to = "Variable", values_to = "Valeur")
ggplot(data_clean_long, aes(x = Variable, y = Valeur)) +
geom_boxplot(fill = "lightblue", outlier.colour = "red", outlier.size = 3) +
theme_minimal() +
labs(title = "Boxplots des variables quantitatives (détection des outliers)",
subtitle = "Méthode IQR × 1.5") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
skim(data_clean)
numeric_vars <- data_clean %>%
select(Age, Poids, Tension, Cholesterol, Suivi_Jours, Symptom_Score)
summary(numeric_vars)
psych::describe(numeric_vars)
numeric_vars_long <- data_clean %>%
select(Age, Poids, Tension, Cholesterol, Suivi_Jours, Symptom_Score) %>%
pivot_longer(cols = everything(), names_to = "Variable", values_to = "Valeur")
ggplot(numeric_vars_long, aes(x = Valeur)) +
geom_histogram(bins = 30, color = "black", fill = "steelblue", alpha = 0.7) +
facet_wrap(~ Variable, scales = "free") +
theme_minimal() +
labs(title = "Histogrammes des variables quantitatives")
ggplot(numeric_vars_long, aes(y = Valeur)) +
geom_boxplot(fill = "tomato", alpha = 0.7) +
facet_wrap(~ Variable, scales = "free") +
theme_minimal() +
labs(title = "Boxplots des variables quantitatives")
apply(numeric_vars, 2, function(x) {
shapiro.test(x)$p.value
})
table(data_clean$Sexe)
prop.table(table(data_clean$Sexe))
table(data_clean$Groupe_Traitement)
prop.table(table(data_clean$Groupe_Traitement))
ggplot(data_clean, aes(x = Sexe)) +
geom_bar(fill = "steelblue") +
theme_minimal() +
labs(title = "Répartition des patients par sexe", x = "Sexe", y = "Effectif")
ggplot(data_clean, aes(x = Groupe_Traitement)) +
geom_bar(fill = "darkseagreen") +
theme_minimal() +
labs(title = "Répartition par groupe de traitement", x = "Groupe de traitement", y = "Effectif")
cor_matrix <- cor(numeric_vars, use = "complete.obs")
cor_matrix
GGally::ggcorr(numeric_vars, label = TRUE)
cor.test(data_clean$Age, data_clean$Symptom_Score)
ggplot(data_clean, aes(x = Age, y = Symptom_Score)) +
geom_point(alpha = 0.7) +
geom_smooth(method = "lm", color = "red", se = TRUE) +
theme_minimal() +
labs(title = "Âge vs Score de symptômes",
x = "Âge",
y = "Score de symptômes")
ggplot(data_clean, aes(x = Groupe_Traitement, y = Symptom_Score, fill = Groupe_Traitement)) +
geom_boxplot(alpha = 0.8) +
theme_minimal() +
labs(title = "Score de symptômes selon le groupe de traitement",
x = "Groupe de traitement",
y = "Score de symptômes") +
theme(legend.position = "none")
anova_model <- aov(Symptom_Score ~ Groupe_Traitement, data = data_clean)
summary(anova_model)
t.test(Symptom_Score ~ Sexe, data = data_clean, var.equal = FALSE)
tab_sexe_traitement <- table(data_clean$Sexe, data_clean$Groupe_Traitement)
tab_sexe_traitement
chisq.test(tab_sexe_traitement)
modele_lm <- lm(
Symptom_Score ~ Age + Sexe + Poids + Tension + Cholesterol + Groupe_Traitement + Suivi_Jours,
data = data_clean
)
summary(modele_lm)
tidy(modele_lm, conf.int = TRUE)
ggplot(data.frame(
fitted = fitted(modele_lm),
resid = resid(modele_lm)
), aes(x = fitted, y = resid)) +
geom_point(alpha = 0.6) +
geom_hline(yintercept = 0, linetype = "dashed") +
theme_minimal() +
labs(title = "Résidus vs valeurs ajustées",
x = "Valeurs ajustées",
y = "Résidus")
qqnorm(resid(modele_lm))
qqline(resid(modele_lm), col = "red")
shapiro.test(resid(modele_lm))
vif(modele_lm)
