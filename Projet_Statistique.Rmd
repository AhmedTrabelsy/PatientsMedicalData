---
title: 'Projet Statistique : Analyse des Donn√©es M√©dicales'
author: "Ton Nom"
date: "`r format(Sys.Date(), '%d/%m/%Y')`"
output:
  html_document:
    theme: flatly
    toc: true
    toc_float: true
    number_sections: true
  pdf_document:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

# . Introduction

##  Contexte
Ce projet vise √† √©tudier un jeu de donn√©es m√©dicales contenant des informations sur les patients : √¢ge, sexe, poids, tension art√©rielle, cholest√©rol, groupe de traitement, dur√©e de suivi et score de sympt√¥mes.

##  Probl√©matique
> Les caract√©ristiques cliniques (√¢ge, poids, tension, cholest√©rol) et le traitement influencent-ils significativement l‚Äô√©tat des patients (score de sympt√¥mes) ?

##  Objectifs
- D√©crire les variables (analyse univari√©e)
- √âtudier les relations entre variables (analyse bivari√©e)
- Construire un mod√®le explicatif (analyse multivari√©e)
- Tester les hypoth√®ses statistiques

#  Pr√©paration des donn√©es

##  Chargement des packages

```{r packages}
# Installer les packages si n√©cessaires :
# install.packages(c("tidyverse", "skimr", "GGally", "psych", "broom"))

library(tidyverse)
library(skimr)
library(GGally)
library(psych)
library(broom)
library(effsize)
```

##  Importation du jeu de donn√©es

```{r import}
data <- read.csv(file.choose(),
                 sep = ";",
                 header = TRUE,
                 stringsAsFactors = FALSE,
                 na.strings = c("", "NA", "NaN", "NULL", "?"))

# üëÄ Aper√ßu rapide du jeu de donn√©es
head(data)
str(data)
```

##  Nettoyage des donn√©es

```{r cleaning}
data <- data %>%
  rename(
    ID = ID,
    Age = Age,
    Sexe = Sexe,
    Poids = Poids,
    Tension = Tension,
    Cholesterol = Cholesterol,
    Groupe_Traitement = Groupe_Traitement,
    Suivi_Jours = Suivi_Jours,
    Symptom_Score = Symptom_Score
  ) %>%
  mutate(
    Sexe = as.factor(Sexe),
    Groupe_Traitement = as.factor(Groupe_Traitement)
  )

# Suppression des doublons
data <- distinct(data)

# R√©sum√© rapide
skim(data)
```

##  Gestion des valeurs manquantes

```{r missing-values}
colSums(is.na(data))
data <- na.omit(data)
nrow(data)
```

#  Analyse univari√©e

##  Variables quantitatives

```{r univariate-num}
quant_vars <- c("Age", "Poids", "Tension", "Cholesterol", "Suivi_Jours", "Symptom_Score")

data %>%
  select(all_of(quant_vars)) %>%
  summary()

# Histogrammes
for (v in quant_vars) {
  print(
    ggplot(data, aes_string(x = v)) +
      geom_histogram(bins = 20, fill = "steelblue", color = "white") +
      geom_density(alpha = 0.4, color = "red") +
      labs(title = paste("Distribution de", v))
  )
}
```

### Test de normalit√© (Shapiro-Wilk)

```{r normality}
for (v in quant_vars) {
  cat("Variable :", v, "\n")
  x <- data[[v]]
  if (length(x) > 5000) x <- sample(x, 5000)
  print(shapiro.test(x))
  cat("\n---------------------------------\n")
}
```

##  Variables qualitatives

```{r univariate-cat}
table(data$Sexe)
table(data$Groupe_Traitement)

ggplot(data, aes(x = Sexe)) +
  geom_bar(fill = "#3498db") +
  labs(title = "R√©partition par sexe", x = "Sexe", y = "Effectif")

ggplot(data, aes(x = Groupe_Traitement)) +
  geom_bar(fill = "#2ecc71") +
  labs(title = "R√©partition par groupe de traitement", x = "Groupe", y = "Effectif")
```

#  Analyse bivari√©e

##  Corr√©lations entre variables quantitatives

```{r correlation}
cor_matrix <- cor(data[, quant_vars])
cor_matrix

GGally::ggcorr(data[, quant_vars], label = TRUE)
```

### Exemple : Corr√©lation entre √¢ge et score de sympt√¥mes

```{r cor-age}
cor.test(data$Age, data$Symptom_Score)
ggplot(data, aes(x = Age, y = Symptom_Score)) +
  geom_point() +
  geom_smooth(method = "lm", color = "red") +
  labs(title = "√Çge vs Score de sympt√¥mes")
```

##  Comparaison de moyennes (score selon le traitement)

```{r anova}
ggplot(data, aes(x = Groupe_Traitement, y = Symptom_Score, fill = Groupe_Traitement)) +
  geom_boxplot() +
  labs(title = "Score selon le groupe de traitement")

# Test ANOVA
anova_test <- aov(Symptom_Score ~ Groupe_Traitement, data = data)
summary(anova_test)

# Test non param√©trique
kruskal.test(Symptom_Score ~ Groupe_Traitement, data = data)
```

##  Variables qualitatives (Sexe vs Groupe de traitement)

```{r chi2}
tab <- table(data$Sexe, data$Groupe_Traitement)
tab
chisq.test(tab)
```
###  Visualisation :

```{r Visualisation}
ggplot(data, aes(x = Sexe, fill = Groupe_Traitement)) +
  geom_bar(position = "fill") +
  scale_y_continuous(labels = scales::percent) +
  labs(title = "R√©partition des groupes de traitement selon le sexe",
       x = "Sexe",
       y = "Proportion") +
  theme_minimal()

```

#  Analyse multivari√©e
##  R√©gression lin√©aire multiple
```{r Mod√®le explicatif}
model_lm <- lm(
  Symptom_Score ~ Age + Poids + Tension + Cholesterol +
    Sexe + Groupe_Traitement + Suivi_Jours,
  data = data
)

summary(model_lm)
```
```{r Tableau de r√©sultats propre}
broom::tidy(model_lm, conf.int = TRUE)
```
##  Diagnostic du mod√®le
```{r V√©rification des hypoth√®ses du mod√®le lin√©aire}
par(mfrow = c(2, 2))
plot(model_lm)
par(mfrow = c(1, 1))
```
#  Mod√©lisation multivari√©e avanc√©e
##  MANOVA globale
```{r MANOVA pour Tension, Cholesterol et Score de sympt√¥mes}
model_mv <- lm(
cbind(Tension, Cholesterol, Symptom_Score) ~
Age + Poids + Sexe + Groupe_Traitement + Suivi_Jours,
data = data
)
summary(manova(model_mv), test = "Pillai")
```
#  R√©gressions univari√©es (mod√®les s√©par√©s)
###  Mod√®le 1 : Tension art√©rielle
```{r Mod√®le 1 Tension art√©rielle}
model_Tension <- lm(
Tension ~ Age + Poids + Sexe + Groupe_Traitement + Suivi_Jours,
data = data
)
summary(model_Tension)

```
###  Mod√®le 2 : Cholest√©rol
```{r Mod√®le 2 Cholest√©rol}
model_Cholesterol <- lm(
Cholesterol ~ Age + Poids + Sexe + Groupe_Traitement + Suivi_Jours,
data = data
)
summary(model_Cholesterol)


```
###  Mod√®le 3 : Score de sympt√¥mes
```{r Mod√®le 3  Score de sympt√¥mes}
model_Symptom <- lm(
Symptom_Score ~ Age + Poids + Sexe + Groupe_Traitement + Suivi_Jours,
data = data
)
summary(model_Symptom)

```
###  Tableau global des coefficients
```{r Tableau global des coefficients}
bind_rows(
broom::tidy(model_Tension, conf.int = TRUE) %>% mutate(Outcome = "Tension"),
broom::tidy(model_Cholesterol, conf.int = TRUE) %>% mutate(Outcome = "Cholest√©rol"),
broom::tidy(model_Symptom, conf.int = TRUE) %>% mutate(Outcome = "Score sympt√¥mes")
) %>%
select(Outcome, term, estimate, conf.low, conf.high, p.value)

```
#  Diagnostics des mod√®les
##  Diagnostics graphiques classiques
```{r Diagnostics graphiques classiques}
par(mfrow = c(2,2))
plot(model_Tension)
plot(model_Cholesterol)
plot(model_Symptom)
par(mfrow = c(1,1))

```
##  Multicolin√©arit√© (VIF)
```{r Multicolin√©arit√©}
# Installer le package 'car' une seule fois
# install.packages("car")

# Charger le package
library(car)

# Calcul des VIF
vif(model_Tension)
vif(model_Cholesterol)
vif(model_Symptom)


```
##  Interpr√©tation des VIF (Variance Inflation Factor) :
Les VIF calcul√©s pour les variables explicatives de nos mod√®les (Age, Poids, Sexe, Groupe_Traitement, Suivi_Jours) sont tous compris entre 1 et 1,16.

Ces valeurs sont tr√®s proches de 1, ce qui indique que les variables ne sont pas corr√©l√©es entre elles.

Aucun probl√®me de multicolin√©arit√© n‚Äôest d√©tect√©.

Cela signifie que les coefficients estim√©s dans les mod√®les de r√©gression peuvent √™tre interpr√©t√©s de mani√®re fiable, sans distorsion due √† des corr√©lations fortes entre variables explicatives.
Conclusion : Les facteurs inclus dans les mod√®les sont ind√©pendants les uns des autres pour l‚Äôanalyse, et les r√©sultats des r√©gressions sont fiables.

##  R√©sidus vs valeurs ajust√©es (ggplot ‚Äì propre)
```{r R√©sidus vs valeurs}
plot_residuals <- function(model, titre) {
ggplot(
data.frame(
fitted = fitted(model),
residuals = resid(model)
),
aes(x = fitted, y = residuals)
) +
geom_point(alpha = 0.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
labs(
title = titre,
x = "Valeurs ajust√©es",
y = "R√©sidus"
) +
theme_minimal()
}

plot_residuals(model_Tension, "Tension ‚Äì R√©sidus vs ajust√©s")
plot_residuals(model_Cholesterol, "Cholest√©rol ‚Äì R√©sidus vs ajust√©s")
plot_residuals(model_Symptom, "Score de sympt√¥mes ‚Äì R√©sidus vs ajust√©s")

```
### Interpr√©tation simplifi√©e




# 6. Limites et perspectives

- Taille d‚Äô√©chantillon limit√©e
- Variables non observ√©es (r√©gime, ant√©c√©dents‚Ä¶)
- Donn√©es manquantes ou non normalis√©es
- Perspectives : ajout de variables, mod√®les non lin√©aires, tests robustes

# 7. Conclusion

Cette √©tude montre les relations entre les caract√©ristiques des patients et leur √©tat de sant√©.
Les analyses descriptives, corr√©lationnelles et de r√©gression permettent de formuler et v√©rifier des hypoth√®ses statistiques fiables.












