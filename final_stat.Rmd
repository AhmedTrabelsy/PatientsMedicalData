---
title: "Projet Statistique : Analyse des donn√©es m√©dicales"
author: "Ton Nom"
date: "`r format(Sys.Date(), '%d/%m/%Y')`"
output:
  html_document:
    theme: flatly
    toc: true
    toc_float: true
    number_sections: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  message = FALSE,
  warning = FALSE
)
```

# . Introduction

## . Contexte

Ce projet porte sur un jeu de **donn√©es m√©dicales** contenant des informations sur des patients :  
- caract√©ristiques d√©mographiques (√¢ge, sexe, poids),  
- indicateurs cliniques (tension art√©rielle, cholest√©rol),  
- informations de suivi (groupe de traitement, dur√©e de suivi),  
- et un **score de sympt√¥mes** r√©sumant l‚Äô√©tat de sant√©.

## . Probl√©matique

> Les caract√©ristiques cliniques (√¢ge, poids, tension, cholest√©rol, etc.) influencent-elles significativement  
> l‚Äô√©tat de sant√© des patients, mesur√© par le **score de sympt√¥mes** ?

## . Objectifs

- üîπ **Analyse descriptive** : d√©crire les variables (statistiques de base, graphiques).
- üîπ **Analyse univari√©e** : √©tudier s√©par√©ment chaque variable.
- üîπ **Analyse bivari√©e** : explorer les relations deux √† deux (corr√©lations, comparaisons de groupes).
- üîπ **Analyse multivari√©e** : construire un **mod√®le explicatif** du score de sympt√¥mes.
- üîπ Fournir des **interpr√©tations claires** et exploitables.

# . M√©thodologie et donn√©es

## . Chargement des packages

```{r packages}
required_packages <- c(
  "tidyverse",
  "skimr",
  "GGally",
  "psych",
  "broom",
  "car"
)

installed <- rownames(installed.packages())
for (p in required_packages) {
  if (!p %in% installed) {
    install.packages(p, dependencies = TRUE)
  }
}

library(tidyverse)
library(skimr)
library(GGally)
library(psych)
library(broom)
library(car)
```

## . Importation du jeu de donn√©es


```{r import_data}
data <- read.csv(
  "patients_medical_data.csv",
  sep = ";",
  header = TRUE,
  stringsAsFactors = FALSE,
  na.strings = c("", "NA", "NaN", "NULL", "?")
)

# Aper√ßu des premi√®res lignes
head(data)

# Structure des donn√©es
str(data)
```

## . Pr√©paration et typage des variables

On suppose les variables suivantes (adapte si besoin √† ton dataset) :

- `Age` : √¢ge en ann√©es (quantitative)
- `Sexe` : "Homme"/"Femme" (qualitative)
- `Poids` : poids en kg (quantitative)
- `Tension` : tension art√©rielle (quantitative)
- `Cholesterol` : taux de cholest√©rol (quantitative)
- `Groupe_Traitement` : type ou groupe de traitement (qualitative)
- `Suivi_Jours` : dur√©e de suivi en jours (quantitative)
- `Symptom_Score` : score de sympt√¥mes (quantitative, variable principale √† expliquer)

```{r recodage}
data <- data %>%
  mutate(
    Sexe = as.factor(Sexe),
    Groupe_Traitement = as.factor(Groupe_Traitement)
  )

# V√©rification des types
str(data)
```

## . Gestion des valeurs manquantes

```{r missing_values}
# Nombre de NA par variable
colSums(is.na(data))

# Proportion de NA par variable
sapply(data, function(x) mean(is.na(x)))
```

Interpr√©tation :  
- Si le pourcentage de NA est **faible (< 5%)**, on peut souvent se permettre de **supprimer** les lignes incompl√®tes.  
- Si le pourcentage est **important**, il faudra envisager une **imputation** (moyenne, m√©diane, etc.).

```{r na_handling}
# Exemple simple : suppression des lignes ayant au moins une valeur manquante
data_clean <- na.omit(data)

dim(data)
dim(data_clean)
```

Texte √† expliquer dans le rapport apr√®s ex√©cution :  
> Nous avons supprim√© les observations comportant des valeurs manquantes.  
> Le nombre d‚Äôobservations est pass√© de `r nrow(data)` √† `r nrow(data_clean)`.  
> Cette √©tape permet de travailler sur un jeu de donn√©es complet.

---

# . Analyse descriptive et univari√©e

## . R√©sum√© global des donn√©es

```{r skim}
skim(data_clean)
```

Interpr√©tation :  
- Les tableaux affichent les **statistiques descriptives** (min, max, moyenne, m√©diane, etc.) pour les variables quantitatives,  
  et les **effectifs** pour les variables qualitatives.

## . Variables quantitatives

On consid√®re ici : `Age`, `Poids`, `Tension`, `Cholesterol`, `Suivi_Jours`, `Symptom_Score`.

```{r desc_quanti}
numeric_vars <- data_clean %>%
  select(Age, Poids, Tension, Cholesterol, Suivi_Jours, Symptom_Score)

summary(numeric_vars)
psych::describe(numeric_vars)
```

### . Histogrammes et boxplots

```{r plots_quanti, fig.height=6, fig.width=8}
numeric_vars_long <- data_clean %>%
  select(Age, Poids, Tension, Cholesterol, Suivi_Jours, Symptom_Score) %>%
  pivot_longer(cols = everything(), names_to = "Variable", values_to = "Valeur")

ggplot(numeric_vars_long, aes(x = Valeur)) +
  geom_histogram(bins = 30, color = "black", fill = "steelblue", alpha = 0.7) +
  facet_wrap(~ Variable, scales = "free") +
  theme_minimal() +
  labs(title = "Histogrammes des variables quantitatives")

ggplot(numeric_vars_long, aes(y = Valeur)) +
  geom_boxplot(fill = "tomato", alpha = 0.7) +
  facet_wrap(~ Variable, scales = "free") +
  theme_minimal() +
  labs(title = "Boxplots des variables quantitatives")
```

Interpr√©tation :  
- Les histogrammes permettent de voir si les distributions sont **sym√©triques** ou **asym√©triques**.  
- Les boxplots mettent en √©vidence d‚Äô√©ventuels **outliers** (valeurs extr√™mes).

### . Test de normalit√© (Shapiro-Wilk)

```{r shapiro, warning=FALSE}
apply(numeric_vars, 2, function(x) {
  shapiro.test(x)$p.value
})
```

Interpr√©tation :  
- Si le **p-value < 0,05**, on rejette l‚Äôhypoth√®se de normalit√© pour la variable.  
- Si le **p-value ‚â• 0,05**, la normalit√© est compatible avec les donn√©es.

## 3.3 Variables qualitatives

On s‚Äôint√©resse ici √† `Sexe` et `Groupe_Traitement`.

```{r desc_quali}
table(data_clean$Sexe)
prop.table(table(data_clean$Sexe))

table(data_clean$Groupe_Traitement)
prop.table(table(data_clean$Groupe_Traitement))
```

```{r bar_quali, fig.height=4, fig.width=8}
ggplot(data_clean, aes(x = Sexe)) +
  geom_bar(fill = "steelblue") +
  theme_minimal() +
  labs(title = "R√©partition des patients par sexe", x = "Sexe", y = "Effectif")

ggplot(data_clean, aes(x = Groupe_Traitement)) +
  geom_bar(fill = "darkseagreen") +
  theme_minimal() +
  labs(title = "R√©partition par groupe de traitement", x = "Groupe de traitement", y = "Effectif")
```

Interpr√©tation (exemple) :  
> On observe une r√©partition des sexes relativement √©quilibr√©e / d√©s√©quilibr√©e.  
> Certains groupes de traitement sont plus repr√©sent√©s que d‚Äôautres.

---

# . Analyse bivari√©e

## . Corr√©lation entre variables quantitatives

```{r corr_matrix}
cor_matrix <- cor(numeric_vars, use = "complete.obs")
cor_matrix
```

```{r corr_plot, fig.height=6, fig.width=6}
GGally::ggcorr(numeric_vars, label = TRUE)
```

Interpr√©tation :  
- Les coefficients de corr√©lation proches de **+1** indiquent une relation **croissante forte**,  
- proches de **-1**, une relation **d√©croissante forte**,  
- proches de **0**, absence de relation lin√©aire.

## . Exemple : √Çge vs score de sympt√¥mes

```{r age_score, fig.height=4, fig.width=6}
cor.test(data_clean$Age, data_clean$Symptom_Score)

ggplot(data_clean, aes(x = Age, y = Symptom_Score)) +
  geom_point(alpha = 0.7) +
  geom_smooth(method = "lm", color = "red", se = TRUE) +
  theme_minimal() +
  labs(title = "√Çge vs Score de sympt√¥mes",
       x = "√Çge",
       y = "Score de sympt√¥mes")
```

Interpr√©tation (√† adapter) :  
> Le coefficient de corr√©lation et le p-value indiquent si l‚Äô√¢ge est significativement li√© au score de sympt√¥mes.  
> Une pente positive signifie que le score augmente avec l‚Äô√¢ge, une pente n√©gative l‚Äôinverse.

## . Score de sympt√¥mes selon le groupe de traitement

### . Visualisation

```{r boxplot_traitement, fig.height=4, fig.width=6}
ggplot(data_clean, aes(x = Groupe_Traitement, y = Symptom_Score, fill = Groupe_Traitement)) +
  geom_boxplot(alpha = 0.8) +
  theme_minimal() +
  labs(title = "Score de sympt√¥mes selon le groupe de traitement",
       x = "Groupe de traitement",
       y = "Score de sympt√¥mes") +
  theme(legend.position = "none")
```

### . ANOVA (si conditions de normalit√©/homog√©n√©it√© raisonnables)

```{r anova_traitement}
anova_model <- aov(Symptom_Score ~ Groupe_Traitement, data = data_clean)
summary(anova_model)
```

Interpr√©tation :  
- Si le **p-value global < 0,05**, il existe une **diff√©rence significative** de score de sympt√¥mes entre au moins deux groupes.  
- Sinon, les moyennes ne diff√®rent pas significativement.

## . Score de sympt√¥mes selon le sexe

```{r ttest_sexe}
t.test(Symptom_Score ~ Sexe, data = data_clean, var.equal = FALSE)
```

Interpr√©tation :  
> Le test de Student permet de comparer la moyenne du score entre les sexes.  
> Si **p < 0,05**, la diff√©rence est significative.

## . Association entre deux variables qualitatives : Sexe √ó Groupe de traitement

```{r chi2}
tab_sexe_traitement <- table(data_clean$Sexe, data_clean$Groupe_Traitement)
tab_sexe_traitement

chisq.test(tab_sexe_traitement)
```

Interpr√©tation :  
- Si le **p-value du œá¬≤ < 0,05**, il existe une association significative entre le sexe et le groupe de traitement.

---

# . Analyse multivari√©e : r√©gression lin√©aire multiple

Nous cherchons √† expliquer le **score de sympt√¥mes** √† partir des autres variables.

## 1 Mod√®le global

```{r lm_model}
modele_lm <- lm(
  Symptom_Score ~ Age + Sexe + Poids + Tension + Cholesterol + Groupe_Traitement + Suivi_Jours,
  data = data_clean
)

summary(modele_lm)
```

Interpr√©tation (g√©n√©rale) :  
- Le **R¬≤** indique la proportion de la variabilit√© du score expliqu√©e par le mod√®le.  
- Chaque coefficient repr√©sente l‚Äôeffet **moyen** de la variable, **√† variables constantes**.  
- Si le p-value d‚Äôun coefficient est **< 0,05**, l‚Äôeffet est statistiquement significatif.

## . Coefficients sous forme de tableau propre

```{r tidy_lm}
tidy(modele_lm, conf.int = TRUE)
```

Tu peux commenter dans le texte :  
> On identifie les variables qui ont un effet significatif sur le score de sympt√¥mes (par ex. √¢ge, tension, etc.).  
> Le signe du coefficient (positif ou n√©gatif) indique le sens de l‚Äôeffet.

## . V√©rification des hypoth√®ses du mod√®le

### . R√©sidus vs valeurs ajust√©es (homosc√©dasticit√©)

```{r resid_vs_fitted, fig.height=4, fig.width=6}
ggplot(data.frame(
  fitted = fitted(modele_lm),
  resid = resid(modele_lm)
), aes(x = fitted, y = resid)) +
  geom_point(alpha = 0.6) +
  geom_hline(yintercept = 0, linetype = "dashed") +
  theme_minimal() +
  labs(title = "R√©sidus vs valeurs ajust√©es",
       x = "Valeurs ajust√©es",
       y = "R√©sidus")
```

Interpr√©tation :  
> On recherche une **dispersion al√©atoire** des r√©sidus autour de 0.  
> Des motifs particuliers (courbe, entonnoir‚Ä¶) peuvent indiquer une violation de l‚Äôhypoth√®se d‚Äôhomosc√©dasticit√©.

### . Normalit√© des r√©sidus

```{r resid_normality, fig.height=4, fig.width=6}
qqnorm(resid(modele_lm))
qqline(resid(modele_lm), col = "red")

shapiro.test(resid(modele_lm))
```

Interpr√©tation :  
- Si les points sont proches de la droite sur le QQ-plot, la normalit√© est raisonnable.  
- Le test de Shapiro (p-value ‚â• 0,05) confirme la normalit√© des r√©sidus.

### . Multicolin√©arit√© (VIF)

```{r vif}
vif(modele_lm)
```

Interpr√©tation :  
- Un **VIF > 5** (ou > 10 selon les auteurs) peut signaler une **colin√©arit√©** importante entre variables explicatives.  
- Dans ce cas, il peut √™tre pertinent de **retirer** ou **combiner** certaines variables.

---

# . Synth√®se et conclusion

## . R√©sum√© des principaux r√©sultats

Dans cette partie, tu peux commenter en texte libre, par exemple :

- Les analyses **descriptives** ont montr√© que :
  - l‚Äô√¢ge moyen des patients est de ‚Ä¶ ans,  
  - la distribution du cholest√©rol est (normale / asym√©trique / avec outliers), etc.
- Les analyses **bivari√©es** ont mis en √©vidence que :
  - il existe / n‚Äôexiste pas de corr√©lation significative entre l‚Äô√¢ge et le score de sympt√¥mes,  
  - certains groupes de traitement pr√©sentent des scores significativement diff√©rents.
- L‚Äôanalyse **multivari√©e** a montr√© que :
  - les variables les plus importantes pour expliquer le score de sympt√¥mes sont ‚Ä¶  
  - le mod√®le explique environ **R¬≤ = ‚Ä¶** de la variabilit√© du score.

## . Conclusion g√©n√©rale

> Ce projet statistique a permis d‚Äôexplorer de mani√®re structur√©e un jeu de donn√©es m√©dicales.  
> Les √©tapes successives (pr√©paration des donn√©es, analyses descriptives, univari√©es, bivari√©es et multivari√©es)  
> ont permis de d√©gager des **facteurs explicatifs** du score de sympt√¥mes.  
> Ces r√©sultats peuvent guider d‚Äô√©ventuelles **d√©cisions cliniques** ou **travaux de recherche futurs**.

